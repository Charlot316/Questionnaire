(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5cb8174a"],{"14c3":function(e,t,n){var i=n("c6b6"),r=n("9263");e.exports=function(e,t){var n=e.exec;if("function"===typeof n){var u=n.call(e,t);if("object"!==typeof u)throw TypeError("RegExp exec method returned something other than an Object or null");return u}if("RegExp"!==i(e))throw TypeError("RegExp#exec called on incompatible receiver");return r.call(e,t)}},"466d":function(e,t,n){"use strict";var i=n("d784"),r=n("825a"),u=n("50c4"),o=n("1d80"),a=n("8aa5"),s=n("14c3");i("match",1,(function(e,t,n){return[function(t){var n=o(this),i=void 0==t?void 0:t[e];return void 0!==i?i.call(t,n):new RegExp(t)[e](String(n))},function(e){var i=n(t,e,this);if(i.done)return i.value;var o=r(e),c=String(this);if(!o.global)return s(o,c);var l=o.unicode;o.lastIndex=0;var d,b=[],p=0;while(null!==(d=s(o,c))){var m=String(d[0]);b[p]=m,""===m&&(o.lastIndex=a(c,u(o.lastIndex),l)),p++}return 0===p?null:b}]}))},"498a":function(e,t,n){"use strict";var i=n("23e7"),r=n("58a8").trim,u=n("c8d2");i({target:"String",proto:!0,forced:u("trim")},{trim:function(){return r(this)}})},5899:function(e,t){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(e,t,n){var i=n("1d80"),r=n("5899"),u="["+r+"]",o=RegExp("^"+u+u+"*"),a=RegExp(u+u+"*$"),s=function(e){return function(t){var n=String(i(t));return 1&e&&(n=n.replace(o,"")),2&e&&(n=n.replace(a,"")),n}};e.exports={start:s(1),end:s(2),trim:s(3)}},"8aa5":function(e,t,n){"use strict";var i=n("6547").charAt;e.exports=function(e,t,n){return t+(n?i(e,t).length:1)}},9263:function(e,t,n){"use strict";var i=n("ad6d"),r=n("9f7f"),u=RegExp.prototype.exec,o=String.prototype.replace,a=u,s=function(){var e=/a/,t=/b*/g;return u.call(e,"a"),u.call(t,"a"),0!==e.lastIndex||0!==t.lastIndex}(),c=r.UNSUPPORTED_Y||r.BROKEN_CARET,l=void 0!==/()??/.exec("")[1],d=s||l||c;d&&(a=function(e){var t,n,r,a,d=this,b=c&&d.sticky,p=i.call(d),m=d.source,f=0,h=e;return b&&(p=p.replace("y",""),-1===p.indexOf("g")&&(p+="g"),h=String(e).slice(d.lastIndex),d.lastIndex>0&&(!d.multiline||d.multiline&&"\n"!==e[d.lastIndex-1])&&(m="(?: "+m+")",h=" "+h,f++),n=new RegExp("^(?:"+m+")",p)),l&&(n=new RegExp("^"+m+"$(?!\\s)",p)),s&&(t=d.lastIndex),r=u.call(b?n:d,h),b?r?(r.input=r.input.slice(f),r[0]=r[0].slice(f),r.index=d.lastIndex,d.lastIndex+=r[0].length):d.lastIndex=0:s&&r&&(d.lastIndex=d.global?r.index+r[0].length:t),l&&r&&r.length>1&&o.call(r[0],n,(function(){for(a=1;a<arguments.length-2;a++)void 0===arguments[a]&&(r[a]=void 0)})),r}),e.exports=a},"9f7f":function(e,t,n){"use strict";var i=n("d039");function r(e,t){return RegExp(e,t)}t.UNSUPPORTED_Y=i((function(){var e=r("a","y");return e.lastIndex=2,null!=e.exec("abcd")})),t.BROKEN_CARET=i((function(){var e=r("^r","gy");return e.lastIndex=2,null!=e.exec("str")}))},ac1f:function(e,t,n){"use strict";var i=n("23e7"),r=n("9263");i({target:"RegExp",proto:!0,forced:/./.exec!==r},{exec:r})},c8d2:function(e,t,n){var i=n("d039"),r=n("5899"),u="​᠎";e.exports=function(e){return i((function(){return!!r[e]()||u[e]()!=u||r[e].name!==e}))}},d784:function(e,t,n){"use strict";n("ac1f");var i=n("6eeb"),r=n("d039"),u=n("b622"),o=n("9263"),a=n("9112"),s=u("species"),c=!r((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")})),l=function(){return"$0"==="a".replace(/./,"$0")}(),d=u("replace"),b=function(){return!!/./[d]&&""===/./[d]("a","$0")}(),p=!r((function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var n="ab".split(e);return 2!==n.length||"a"!==n[0]||"b"!==n[1]}));e.exports=function(e,t,n,d){var m=u(e),f=!r((function(){var t={};return t[m]=function(){return 7},7!=""[e](t)})),h=f&&!r((function(){var t=!1,n=/a/;return"split"===e&&(n={},n.constructor={},n.constructor[s]=function(){return n},n.flags="",n[m]=/./[m]),n.exec=function(){return t=!0,null},n[m](""),!t}));if(!f||!h||"replace"===e&&(!c||!l||b)||"split"===e&&!p){var v=/./[m],q=n(m,""[e],(function(e,t,n,i,r){return t.exec===o?f&&!r?{done:!0,value:v.call(t,n,i)}:{done:!0,value:e.call(n,t,i)}:{done:!1}}),{REPLACE_KEEPS_$0:l,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:b}),g=q[0],O=q[1];i(String.prototype,e,g),i(RegExp.prototype,m,2==t?function(e,t){return O.call(e,this,t)}:function(e){return O.call(e,this)})}d&&a(RegExp.prototype[m],"sham",!0)}},dd3b:function(e,t,n){},ed58:function(e,t,n){"use strict";function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.r(t);n("b0c0");var r=n("7a23"),u=Object(r["gb"])("data-v-0bc0f819");Object(r["I"])("data-v-0bc0f819");var o={class:"QuestionnaireEditor"},a={class:"grid-content middle-container"},s={class:"questionnaire-title"},c={class:"question"},l={class:"questionnaire-item"},d={class:"submit-button"},b=Object(r["o"])("span",null,"提交",-1),p=Object(r["o"])("div",{class:"leave-blank"},null,-1);Object(r["G"])();var m=u((function(e,t,n,m,f,h){var v=Object(r["O"])("el-tag"),q=Object(r["O"])("el-affix"),g=Object(r["O"])("el-divider"),O=Object(r["O"])("radio"),y=Object(r["O"])("checkbox"),k=Object(r["O"])("simplefill"),x=Object(r["O"])("multiplefill"),j=Object(r["O"])("rate"),S=Object(r["O"])("el-button"),w=Object(r["O"])("el-scrollbar"),I=Object(r["O"])("el-card"),T=Object(r["O"])("el-col"),E=Object(r["O"])("el-row");return Object(r["F"])(),Object(r["k"])("div",o,[Object(r["o"])(E,null,{default:u((function(){return[Object(r["o"])(T,{class:"Container",span:h.checkSpan(),offset:h.checkOffset()},{default:u((function(){return[Object(r["o"])(I,{class:"box-card"},{default:u((function(){return[3==f.questionnaire.type?(Object(r["F"])(),Object(r["k"])(q,{key:0,class:"affix",offset:22},{default:u((function(){return[Object(r["o"])(v,{type:"warning"},{default:u((function(){return[Object(r["n"])(" 剩余时间："+Object(r["S"])(f.year?h.yearString+"年:"+h.dayString+"天:"+h.hourString+"时:"+h.minuteString+"分:"+h.secondString+"秒":f.day?h.dayString+"天:"+h.hourString+"时:"+h.minuteString+"分:"+h.secondString+"秒":f.hour?h.hourString+"时:"+h.minuteString+"分:"+h.secondString+"秒":h.minuteString+"分:"+h.secondString+"秒"),1)]})),_:1})]})),_:1})):Object(r["l"])("",!0),Object(r["o"])("div",a,[Object(r["o"])(w,null,{default:u((function(){return[Object(r["o"])("div",s,[Object(r["o"])("h1",null,Object(r["S"])(f.questionnaire.name),1),Object(r["o"])("span",null,Object(r["S"])(f.questionnaire.introduction),1)]),(Object(r["F"])(!0),Object(r["k"])(r["b"],null,Object(r["M"])(f.questionnaire.questions,(function(e,t){return Object(r["F"])(),Object(r["k"])("div",{class:"questionnaire-item",key:t},[Object(r["o"])(g,{class:"el-divider"}),Object(r["o"])("div",null,[Object(r["o"])("div",c,[5===e.type||0===e.type?(Object(r["F"])(),Object(r["k"])(O,Object(r["v"])({key:0},f.questionnaire.questions[t],{bigType:f.questionnaire.type,isNumber:f.questionnaire.isNumber,onUpdateValue:h.updateValue}),null,16,["bigType","isNumber","onUpdateValue"])):6===e.type||1===e.type?(Object(r["F"])(),Object(r["k"])(y,Object(r["v"])(i({key:1},"key",f.checkboxKey),f.questionnaire.questions[t],{bigType:f.questionnaire.type,isNumber:f.questionnaire.isNumber,onUpdateValue:h.updateValue}),null,16,["bigType","isNumber","onUpdateValue"])):3===e.type||7===e.type?(Object(r["F"])(),Object(r["k"])(k,Object(r["v"])({key:2},f.questionnaire.questions[t],{bigType:f.questionnaire.type,isNumber:f.questionnaire.isNumber,onUpdateValue:h.updateValue}),null,16,["bigType","isNumber","onUpdateValue"])):4===e.type?(Object(r["F"])(),Object(r["k"])(x,Object(r["v"])({key:3},f.questionnaire.questions[t],{bigType:f.questionnaire.type,isNumber:f.questionnaire.isNumber,onUpdateValue:h.updateValue}),null,16,["bigType","isNumber","onUpdateValue"])):2===e.type?(Object(r["F"])(),Object(r["k"])(j,Object(r["v"])({key:4},f.questionnaire.questions[t],{bigType:f.questionnaire.type,isNumber:f.questionnaire.isNumber,onUpdateValue:h.updateValue}),null,16,["bigType","isNumber","onUpdateValue"])):Object(r["l"])("",!0)])])])})),128)),Object(r["o"])("div",l,[Object(r["o"])(g,{class:"el-divider"}),Object(r["o"])("span",d,[1==e.enabled?(Object(r["F"])(),Object(r["k"])(S,{key:0,class:"el-button",icon:"el-icon-s-claim",type:"primary",onClick:h.handleSubmit},{default:u((function(){return[b]})),_:1},8,["onClick"])):Object(r["l"])("",!0)])]),p]})),_:1})])]})),_:1})]})),_:1},8,["span","offset"])]})),_:1})])})),f=n("1da1"),h=(n("96cf"),n("ac1f"),n("466d"),n("d81d"),n("498a"),n("f4ba"),n("800f")),v=n("943e"),q=n("9c2d"),g=n("0e00"),O=n("0273"),y={emits:["addRadioOption"],components:{Radio:h["a"],Checkbox:v["a"],Simplefill:q["a"],Multiplefill:g["a"],Rate:O["a"]},data:function(){return{year:"",day:"",hour:"",minute:"",second:"",timer:"",remainTime:"",checkboxKey:0,device:"",selecting:-1,questionnaire:{enabled:!0,name:"",introduction:"",startTime:"",endTime:"",isRepeat:0,isLogin:0,isAppoint:0,isNumber:0,questions:[],type:0}}},created:function(){var e=this;return Object(f["a"])(regeneratorRuntime.mark((function t(){var n,i,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return navigator.userAgent.match(/(phone|pad|pod|iPad|iPod|iPhone|ios|Android|Mobile|IEMobile|BlackBerry|JUC|Fennec|wOSBrowser|WebOS|MQQBrowser|BrowserNG|Symbian|Windows Phone)/i)?e.device="mobile":e.device="PC",e.enabled=!0,t.next=4,e.$http.post("/api/admin/questionnaire/answering",{questionnaireId:e.$route.query.questionnaireId,code:e.$route.query.code,ip:sessionStorage.getItem("ip")});case 4:if(n=t.sent,i=n.data,0!==i.code){t.next=38;break}e.questionnaire=i.data,e.initWebSocket(),r=0;case 10:if(!(r<e.questionnaire.questions.length)){t.next=36;break}e.questionnaire.questions[r].order=r+1,e.questionnaire.questions[r].disabled=!1,t.t0=e.questionnaire.questions[r].type,t.next=0===t.t0?16:1===t.t0?18:2===t.t0?20:3===t.t0?22:4===t.t0?24:5===t.t0?26:6===t.t0?28:7===t.t0?30:32;break;case 16:return e.questionnaire.questions[r].value=null,t.abrupt("break",33);case 18:return e.questionnaire.questions[r].value=[],t.abrupt("break",33);case 20:return e.questionnaire.questions[r].value=null,t.abrupt("break",33);case 22:return e.questionnaire.questions[r].value=null,t.abrupt("break",33);case 24:return e.questionnaire.questions[r].value=[],t.abrupt("break",33);case 26:return e.questionnaire.questions[r].value=null,t.abrupt("break",33);case 28:return e.questionnaire.questions[r].value=[],t.abrupt("break",33);case 30:return e.questionnaire.questions[r].value=null,t.abrupt("break",33);case 32:return t.abrupt("break",33);case 33:r++,t.next=10;break;case 36:t.next=41;break;case 38:e.questionnaire={},e.enabled=!1,e.$message.error(i.data);case 41:e.remainTime=parseInt((new Date(e.questionnaire.endTime).getTime()-(new Date).getTime())/1e3),e.remainTime>0&&(e.year=Math.floor(e.remainTime/3600/24/365),e.day=Math.floor(e.remainTime/3600/24%365),e.hour=Math.floor(e.remainTime/3600%24),e.minute=Math.floor(e.remainTime/60%60),e.second=Math.floor(e.remainTime%60),e.countDowm());case 43:case"end":return t.stop()}}),t)})))()},methods:{checkSpan:function(){return"mobile"===this.device?22:10},checkOffset:function(){return"mobile"===this.device?1:7},handleSubmit:function(){var e=this;return Object(f["a"])(regeneratorRuntime.mark((function t(){var n,i,r,u;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n={questionSubmitDTOS:[]},n.questionnaireId=e.$route.query.questionnaireId,n.ip=sessionStorage.getItem("ip"),i=!0,e.questionnaire.questions.map((function(e){if(1==e.isCompulsory)switch(e.type){case 6:case 1:0==e.value.length&&(i=!1);break;case 2:!e.value>0&&(i=!1);break;case 3:case 7:(null==e.value||0==e.value.trim().length)&&(i=!1);break;case 4:var t=0;e.value.map((function(e){t++,e?0==e.trim().length&&(i=!1):i=!1})),t!=e.max&&(i=!1);break;default:null==e.value&&(i=!1);break}if(Array.isArray(e.value))if(1!=e.type&&6!=e.type||e.value.sort(),4==e.type){var r=0;while(r<e.max)e.value[r]?n.questionSubmitDTOS.push({questionId:e.questionId,content:e.value[r]}):n.questionSubmitDTOS.push({questionId:e.questionId,content:""}),r++}else e.value.length>0?e.value.map((function(t){n.questionSubmitDTOS.push({questionId:e.questionId,content:t})})):n.questionSubmitDTOS.push({questionId:e.questionId,content:""});else 2!==e.type&&null!==e.value&&e.value&&void 0!==e.value||2==e.type&&e.value>0?n.questionSubmitDTOS.push({questionId:e.questionId,content:e.value}):n.questionSubmitDTOS.push({questionId:e.questionId,content:""})})),!i){t.next=13;break}return t.next=8,e.$http.post("/api/admin/questionnaireContent",n);case 8:r=t.sent,u=r.data,0===u.code?(3===e.questionnaire.type&&(e.questionnaire.submitRecordId=u.data),e.$message.success("提交答卷成功"),1===e.questionnaire.type?e.$router.push({name:"votingresult",params:{questionnaireId:e.$route.query.questionnaireId}}):3===e.questionnaire.type?e.$router.push({name:"examresult",params:{questionnaireId:e.$route.query.questionnaireId,ip:sessionStorage.getItem("ip"),submitRecordId:e.questionnaire.submitRecordId}}):e.$router.push("/answercompleted")):e.$message.error(u.data),t.next=14;break;case 13:e.$message.error("请作答完所有必答题");case 14:case"end":return t.stop()}}),t)})))()},updateValue:function(e){this.questionnaire.questions[e[0]-1].value=e[1]},initWebSocket:function(){var e="ws://47.93.249.243:8090/websocket/"+this.$route.query.questionnaireId+"&"+(new Date).getTime();this.websock=new WebSocket(e),this.websock.onmessage=this.websocketonmessage,this.websock.onopen=this.websocketonopen,this.websock.onerror=this.websocketonerror,this.websock.onclose=this.websocketclose},websocketonopen:function(){},websocketonerror:function(){this.initWebSocket()},websocketonmessage:function(e){if("连接成功！"!=e.data)for(var t=JSON.parse(e.data),n=0;n<this.questionnaire.questions.length;n++){this.questionnaire.questions[n].order=n+1;for(var i=0;i<this.questionnaire.questions[n].choices.length;i++)this.questionnaire.questions[n].choices[i].nowCount=t.questions[n].choices[i].nowCount}},websocketsend:function(e){this.websock.send(e)},websocketclose:function(e){},countDowm:function(){var e=this;clearInterval(this.timer),this.timer=setInterval((function(){0===e.year?0===e.day?0===e.hour?0!==e.minute&&0===e.second?(5===e.minute&&e.$message.warning("考试剩余5分钟，注意填写必答题"),e.second=59,e.minute-=1):0===e.minute&&0===e.second?(e.second=0,e.handleSubmit(),clearInterval(e.timer)):e.second-=1:0!==e.minute&&0===e.second?(e.second=59,e.minute-=1):0===e.minute&&0===e.second?(e.hour-=1,e.minute=59,e.second=59):e.second-=1:0===e.hour?0!==e.minute&&0===e.second?(e.second=59,e.minute-=1):0===e.minute&&0===e.second?(e.second=59,e.minute=59,e.hour=23,e.day-=1):e.second-=1:0!==e.minute&&0===e.second?(e.second=59,e.minute-=1):0===e.minute&&0===e.second?(e.hour-=1,e.minute=59,e.second=59):e.second-=1:0===e.day?0===e.hour?0!==e.minute&&0===e.second?(e.second=59,e.minute-=1):0===e.minute&&0===e.second?(e.second=59,e.minute=59,e.hour=23,e.day=364,e.year-=1):e.second-=1:0!==e.minute&&0===e.second?(e.second=59,e.minute-=1):0===e.minute&&0===e.second?(e.hour-=1,e.minute=59,e.second=59):e.second-=1:0===e.hour?0!==e.minute&&0===e.second?(e.second=59,e.minute-=1):0===e.minute&&0===e.second?(e.second=59,e.minute=59,e.hour=23,e.day-=1):e.second-=1:0!==e.minute&&0===e.second?(e.second=59,e.minute-=1):0===e.minute&&0===e.second?(e.hour-=1,e.minute=59,e.second=59):e.second-=1}),1e3)},formatNum:function(e){return e<10?"0"+e:""+e}},computed:{tagsList:function(){return this.$store.state.tagsList.map((function(e){return e.name}))},collapse:function(){return this.$store.state.collapse},yearString:function(){return this.formatNum(this.year)},dayString:function(){return this.formatNum(this.day)},hourString:function(){return this.formatNum(this.hour)},minuteString:function(){return this.formatNum(this.minute)},secondString:function(){return this.formatNum(this.second)}}};n("f368");y.render=m,y.__scopeId="data-v-0bc0f819";t["default"]=y},f368:function(e,t,n){"use strict";n("dd3b")}}]);
//# sourceMappingURL=chunk-5cb8174a.2e4d9b46.js.map